<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [WebApiBridge][1]
    -   [apis][2]
    -   [ipc][3]
    -   [listener][4]
    -   [origin][5]
    -   [targetOrigin][6]
    -   [onMessage][7]
        -   [Parameters][8]
    -   [send][9]
        -   [Parameters][10]

## WebApiBridge

`WebApiBridge` is a JavaScript class that can be used in a React Native application
and in a web app running in a React Native [WebView][11]
to support a function call interface between the two. It can also be used as an IPC mechanism
between a web site and the code running in an iframe.

WebApiBridge works by passing `Message` objects between Javascript processes.
A `prop-types` declaration of a Message object would look like this:

```javascript
  export const Message = PropTypes.shape({
    type: PropTypes.oneOf(['response', 'request']),
    msgId: PropTypes.number,
    targetFunc: PropTypes.string,
    args: PropTypes.arrayOf(PropTypes.any),
    wantResult: PropTypes.bool,
  });
```

### apis

Property of the api objects that contain methods for incoming api function
calls. This is an array of objects so that a single `WebViewApi` can have
multiple APIs. The last API with a function is used if the function exists
in more than one API.

### ipc

Property for the Inter Process Communications object that will handle
messages from the other-side. This is the `window` object on a web page
and the `ref` for the `WebView` component on the React Native side.

### listener

Listener functions can monitor all `Message` objects exchanged
between `WebApiBridge` objects. Listener functions are attached to `WebApiBridge` instances
by setting the `listener` property.

### origin

Property for validating the origin of received messages. The property is set to a substring
of the origin to be matched in browser windows. This makes it easy to provide some checking
in development mode, for example, `':3000'` will allow messages from any server using port
3000\. By default it's set to `''`, which will allow messages from any origin. This field
should be set as restrictrively as possible. e.g. `'https://www.mydomain.com:3000'`. Note
that his property is irrelevant in React Native WebViews.

### targetOrigin

Property for specifying the origin of the target window in messages sent to browser windows.
By default it's set to `'*'`, which will allow messages to any document. This field
should be set as restrictrively as possible. e.g. `'https://www.mydomain.com:3000'`. Note
that his property is irrelevant in React Native WebViews.

### onMessage

Function that should get called when an event containing a message is received
from the other side.

#### Parameters

-   `event` **[object][12]** Incomming event.
-   `data` **[string][13]** The incoming data received, which is a stingified JSON
    message. Defaults to `event.nativeEvent.data`, which is correct for React Native
    but needs to be overridden for the web app with `event.data`. (optional, default `event.nativeEvent.data`)

### send

Invoke a function on the remote.
Returns a `Promise` object.

#### Parameters

-   `targetFunc` **[string][13]** A string of the name of the api function to execute.
-   `args` **[Array][14]** An array of parameters to be passsed to the `targetFun`.
-   `wantResult` **[boolean][15]** Boolean to indicate if a `Promise` should be `fullfilled`
       or `rejected` after the remote api completes the call. If `false` then no `Promise`
       will be `fullfilled`. (optional, default `false`)

Returns **[Promise][16]** Promise object if `wantResult` is `true`, `null` if not.

[1]: #webapibridge

[2]: #apis

[3]: #ipc

[4]: #listener

[5]: #origin

[6]: #targetorigin

[7]: #onmessage

[8]: #parameters

[9]: #send

[10]: #parameters-1

[11]: https://facebook.github.io/react-native/docs/webview.html

[12]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[13]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[14]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array

[15]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean

[16]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise
