// @flow
/*
 * WebApiBridge should be left as a pure JS implementation. In order to
 * support flow these declarations are supported in a separate .flow file.
 */

/**
 * `Message` objects are exchanged between the react native app and a
 * webview. They can be monitored by attaching a `Listener` to the `WebApiBridge`
 * through a `WebViewApi` object.
 */
export type Message = {
  type: "response" | "request",
  msgId: number,
  targetFunc: string,
  args: Array<mixed>,
  wantResult: boolean
};
/**
  * `Listener` functions can monitor all `Message` objects exchanged between `WebApiBridge`
  * objects. `Listener` functions are attached to WebApiBridge` objects by setting the
  * `WebApiBridge listener` property. In a react application this would be done in the `WebViewApi`
  * that wants to listen to the bridge.
  */
export type Listener = (message: Message) => void;
export type Send = (apiCall: string, params: ?any[], wantResult?: boolean) => void;
export type OnMessage = (event: string, data: {}) => void;

declare export default class WebApiBridge {
  listener: ?Listener;
  ipc: {};
  send: Send;
  apis: {}[];
  onMessage: OnMessage;
}
